/* ════════════════════════════════════════════════════════════════════════
   Attack Path Forecaster — BloodHound-Style Dark Theme
   ════════════════════════════════════════════════════════════════════════ */

* { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg:        #08090e;
  --surface:   #0f1117;
  --surface2:  #181b26;
  --surface3:  #1e2236;
  --border:    #232740;
  --border-hl: #2d3456;
  --text:      #e1e4ed;
  --text2:     #c5c9d8;
  --muted:     #6b7194;
  --accent:    #4a90d9;
  --accent2:   #6366f1;
  --danger:    #ef4444;
  --success:   #22c55e;
  --warning:   #f59e0b;
  --orange:    #f97316;
  --purple:    #8b5cf6;
  --teal:      #14b8a6;
  --radius:    8px;
  --radius-lg: 12px;
  --shadow:    0 4px 24px rgba(0,0,0,.5);
  --shadow-sm: 0 2px 8px rgba(0,0,0,.3);
  --transition: 0.3s cubic-bezier(.4,0,.2,1);
}

body {
  font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  overflow: hidden;
}

/* ── App Layout ─────────────────────────────────────────────────────── */
.app {
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* ── Top Bar ────────────────────────────────────────────────────────── */
.topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 20px;
  height: 48px;
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
  z-index: 100;
}
.topbar-left {
  display: flex;
  align-items: center;
  gap: 12px;
}
.topbar-logo {
  font-size: 20px;
  filter: saturate(1.5);
}
.topbar-title {
  font-size: 15px;
  font-weight: 600;
  color: var(--text);
  letter-spacing: -0.3px;
}
.topbar-badge {
  background: var(--surface2);
  padding: 3px 10px;
  border-radius: 20px;
  font-size: 11px;
  color: var(--muted);
  border: 1px solid var(--border);
  letter-spacing: 0.3px;
}
.topbar-right {
  display: flex;
  align-items: center;
  gap: 10px;
}
.topbar-status {
  font-size: 12px;
  padding: 4px 10px;
  border-radius: 6px;
}
.loading-pulse {
  color: var(--warning);
  animation: pulse 1.2s ease-in-out infinite;
}
.topbar-error {
  color: var(--danger);
  background: rgba(239,68,68,.1);
}
.topbar-btn {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 6px 12px;
  background: var(--surface2);
  color: var(--muted);
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 12px;
  cursor: pointer;
  transition: var(--transition);
}
.topbar-btn:hover {
  background: var(--surface3);
  color: var(--text);
}
.topbar-btn.active {
  background: rgba(74,144,217,.12);
  color: var(--accent);
  border-color: rgba(74,144,217,.3);
}

@keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:.4; } }

/* ── Workspace ──────────────────────────────────────────────────────── */
.workspace {
  display: flex;
  flex: 1;
  overflow: hidden;
  position: relative;
}

.graph-area {
  flex: 1;
  position: relative;
  overflow: hidden;
}

/* ── Sidebar ────────────────────────────────────────────────────────── */
.sidebar {
  background: var(--surface);
  border-left: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  transition: width var(--transition);
  overflow: hidden;
  z-index: 50;
}
.sidebar--open {
  width: 400px;
  min-width: 400px;
}
.sidebar--closed {
  width: 0;
  min-width: 0;
  border-left: none;
}

/* Tab bar */
.sidebar-tabs {
  display: flex;
  border-bottom: 1px solid var(--border);
  background: var(--surface2);
  flex-shrink: 0;
}
.sidebar-tab {
  flex: 1;
  padding: 10px 8px;
  font-size: 12px;
  font-weight: 500;
  color: var(--muted);
  background: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: var(--transition);
  text-align: center;
}
.sidebar-tab:hover {
  color: var(--text2);
  background: rgba(255,255,255,.02);
}
.sidebar-tab.active {
  color: var(--accent);
  border-bottom-color: var(--accent);
  background: rgba(74,144,217,.05);
}

.sidebar-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
}
.sidebar-content::-webkit-scrollbar { width: 5px; }
.sidebar-content::-webkit-scrollbar-track { background: transparent; }
.sidebar-content::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

/* ── Graph Container ────────────────────────────────────────────────── */
.graph-container {
  width: 100%;
  height: 100%;
  background: var(--bg);
  position: relative;
}

/* React Flow control overrides */
.react-flow__controls {
  border: 1px solid var(--border) !important;
  border-radius: var(--radius) !important;
  box-shadow: var(--shadow-sm) !important;
  overflow: hidden;
}
.react-flow__controls button {
  background: var(--surface2) !important;
  border-bottom: 1px solid var(--border) !important;
  fill: var(--muted) !important;
  color: var(--muted) !important;
  width: 28px !important;
  height: 28px !important;
}
.react-flow__controls button:hover {
  background: var(--surface3) !important;
  fill: var(--text) !important;
}

/* ── Graph Search Bar (BloodHound-style) ────────────────────────────── */
.graph-search {
  position: absolute;
  top: 12px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 24px;
  padding: 0 14px;
  height: 38px;
  min-width: 280px;
  max-width: 400px;
  box-shadow: var(--shadow);
  z-index: 20;
  transition: var(--transition);
}
.graph-search:focus-within {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(74,144,217,.15), var(--shadow);
}
.graph-search-icon {
  font-size: 14px;
  color: var(--muted);
  margin-right: 8px;
}
.graph-search-input {
  flex: 1;
  background: transparent;
  border: none;
  outline: none;
  color: var(--text);
  font-size: 13px;
  font-family: inherit;
}
.graph-search-input::placeholder {
  color: var(--muted);
}
.graph-search-clear {
  background: none;
  border: none;
  color: var(--muted);
  cursor: pointer;
  font-size: 12px;
  padding: 2px;
}
.graph-search-clear:hover {
  color: var(--danger);
}

/* ── Stats Bar ──────────────────────────────────────────────────────── */
.graph-stats-bar {
  position: absolute;
  top: 12px;
  right: 12px;
  display: flex;
  gap: 6px;
  z-index: 20;
}
.stat-chip {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 5px 10px;
  background: rgba(15,17,23,.85);
  backdrop-filter: blur(8px);
  border: 1px solid var(--border);
  border-radius: 20px;
  font-size: 11px;
  color: var(--text2);
}
.stat-dot {
  display: inline-block;
  width: 7px;
  height: 7px;
  border-radius: 50%;
}
.stat-active {
  border-color: rgba(255,107,0,.3);
  color: #ff6b00;
  font-weight: 600;
}

/* ── Zone Overlays ──────────────────────────────────────────────────── */
.zone-overlay {
  pointer-events: none;
}
.zone-label {
  font-size: 11px;
  font-weight: 600;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  padding: 4px 10px;
  border-radius: 6px;
  opacity: 0.7;
}
.zone-label[data-type="User"]     { color: #2563eb; }
.zone-label[data-type="Group"]    { color: #059669; }
.zone-label[data-type="Computer"] { color: #d97706; }
.zone-label[data-type="Server"]   { color: #dc6b20; }

/* ── Legend ──────────────────────────────────────────────────────────── */
.legend {
  position: absolute;
  bottom: 12px;
  left: 12px;
  display: flex;
  gap: 12px;
  background: rgba(15,17,23,.9);
  backdrop-filter: blur(10px);
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 11px;
  border: 1px solid var(--border);
  z-index: 20;
}
.legend-item {
  display: flex;
  align-items: center;
  gap: 5px;
  color: var(--muted);
}
.legend-active {
  color: #ff6b00;
  font-weight: 600;
}
.legend-icon {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
}
.legend-user   { background: #2563eb; }
.legend-group  { background: #059669; }
.legend-server { background: #dc6b20; }
.legend-hv     { background: #dc2626; }
.legend-path   { background: #ff6b00; box-shadow: 0 0 6px #ff6b00; }

/* ── Icon Nodes ─────────────────────────────────────────────────────── */
.icon-node {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 18px 10px 12px;
  border-radius: var(--radius);
  color: #fff;
  border: 1.5px solid rgba(255,255,255,.1);
  min-width: 140px;
  font-size: 13px;
  transition: all var(--transition);
  box-shadow: var(--shadow-sm);
  position: relative;
  cursor: pointer;
}
.icon-node:hover {
  border-color: rgba(255,255,255,.25);
  transform: scale(1.04);
  box-shadow: var(--shadow);
}
.icon-node__icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  background: rgba(255,255,255,.12);
  border-radius: 6px;
  flex-shrink: 0;
}
.icon-node__label {
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-size: 13px;
  letter-spacing: 0.2px;
}
.icon-node__badge {
  position: absolute;
  top: -8px;
  right: -8px;
  background: #ef4444;
  color: #fff;
  font-size: 8px;
  font-weight: 700;
  padding: 3px 6px;
  border-radius: 4px;
  letter-spacing: 0.5px;
  box-shadow: 0 1px 4px rgba(239,68,68,.5);
  animation: badge-pulse 2s ease-in-out infinite;
}
.icon-handle {
  width: 5px !important;
  height: 5px !important;
  background: rgba(255,255,255,.25) !important;
  border: none !important;
}

/* ── Highlighted node (active path) ─────────────────────────────────── */
.icon-node--hl {
  border-color: #ff6b00 !important;
  box-shadow:
    0 0 12px rgba(255,107,0,.45),
    0 0 28px rgba(255,107,0,.2),
    inset 0 0 10px rgba(255,107,0,.12);
  transform: scale(1.08);
  z-index: 10;
  animation: node-glow 2s ease-in-out infinite;
}
.icon-node--hl .icon-node__icon {
  background: rgba(255,107,0,.3);
}

/* ── High Value Target ──────────────────────────────────────────────── */
.icon-node--hv {
  border-color: rgba(239,68,68,.4);
  box-shadow: 0 0 16px rgba(239,68,68,.25);
}

/* ── Animations ─────────────────────────────────────────────────────── */
@keyframes node-glow {
  0%, 100% { box-shadow: 0 0 12px rgba(255,107,0,.45), 0 0 28px rgba(255,107,0,.2); }
  50%      { box-shadow: 0 0 20px rgba(255,107,0,.6), 0 0 40px rgba(255,107,0,.3); }
}
@keyframes badge-pulse {
  0%, 100% { transform: scale(1); }
  50%      { transform: scale(1.12); }
}
.react-flow__edge.animated path {
  stroke-dasharray: 8 4;
  animation: edge-flow 1s linear infinite;
}
@keyframes edge-flow {
  to { stroke-dashoffset: -12; }
}

/* ── Panels ─────────────────────────────────────────────────────────── */
.panel {
  padding: 16px;
  border-bottom: 1px solid var(--border);
}
.panel h3 {
  font-size: 12px;
  margin-bottom: 14px;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--muted);
  font-weight: 600;
}
.panel h4 {
  font-size: 12px;
  margin: 14px 0 8px;
  color: var(--accent);
  font-weight: 600;
}

/* ── Form ───────────────────────────────────────────────────────────── */
.field { margin-bottom: 12px; }
.field label {
  display: block;
  font-size: 11px;
  color: var(--muted);
  margin-bottom: 5px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.field select {
  width: 100%;
  padding: 8px 10px;
  background: var(--surface2);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  font-size: 13px;
  transition: var(--transition);
}
.field select:focus {
  border-color: var(--accent);
  outline: none;
}
.checkbox-group {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}
.checkbox-label {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 12px;
  cursor: pointer;
  padding: 4px 8px;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 6px;
  transition: var(--transition);
}
.checkbox-label:hover {
  border-color: var(--accent);
}

/* ── Buttons ────────────────────────────────────────────────────────── */
.btn-primary {
  width: 100%;
  padding: 10px;
  background: linear-gradient(135deg, var(--accent) 0%, var(--accent2) 100%);
  color: #fff;
  border: none;
  border-radius: var(--radius);
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  margin-top: 10px;
  transition: var(--transition);
  box-shadow: 0 2px 12px rgba(74,144,217,.25);
}
.btn-primary:hover {
  filter: brightness(1.1);
  box-shadow: 0 4px 20px rgba(74,144,217,.35);
  transform: translateY(-1px);
}
.btn-primary:active {
  transform: translateY(0);
}

.btn-sm {
  padding: 3px 10px;
  background: var(--surface2);
  color: var(--accent);
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 10px;
  cursor: pointer;
  transition: var(--transition);
  font-weight: 500;
}
.btn-sm:hover {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
}

/* ── Metrics Cards ──────────────────────────────────────────────────── */
.metrics {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}
.metric {
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px 8px;
  text-align: center;
  transition: var(--transition);
}
.metric:hover {
  border-color: var(--border-hl);
  background: var(--surface3);
}
.metric-value {
  display: block;
  font-size: 24px;
  font-weight: 700;
  color: var(--accent);
  line-height: 1.2;
}
.metric-label {
  font-size: 9px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-top: 4px;
}

/* ── Data Table ─────────────────────────────────────────────────────── */
.data-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 11px;
}
.data-table th {
  text-align: left;
  padding: 8px 8px;
  color: var(--muted);
  border-bottom: 1px solid var(--border);
  font-weight: 500;
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.data-table td {
  padding: 8px 8px;
  border-bottom: 1px solid rgba(35,39,64,.5);
}
.data-table tr {
  cursor: pointer;
  transition: var(--transition);
}
.data-table tr:hover {
  background: rgba(74,144,217,.06);
}
.data-table tr.selected {
  background: rgba(74,144,217,.12);
  border-left: 3px solid var(--accent);
}

/* ── Critical Edges ─────────────────────────────────────────────────── */
.critical-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.critical-item {
  padding: 8px 10px;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  font-size: 11px;
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  align-items: center;
  transition: var(--transition);
}
.critical-item:hover {
  border-color: var(--border-hl);
}
.critical-item em {
  color: var(--warning);
  font-style: normal;
  font-weight: 600;
}
.critical-item.highlight {
  border: 1px solid var(--danger);
  background: rgba(239,68,68,.06);
}
.badge-sm {
  margin-left: auto;
  background: var(--bg);
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 10px;
  color: var(--muted);
  border: 1px solid var(--border);
}

/* ── Scenarios ──────────────────────────────────────────────────────── */
.scenario-buttons {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.btn-scenario {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  padding: 12px 14px;
  background: var(--surface2);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  text-align: left;
  transition: var(--transition);
  width: 100%;
}
.btn-scenario:hover {
  border-color: var(--accent);
  background: var(--surface3);
  transform: translateX(2px);
}
.btn-scenario:disabled {
  opacity: 0.5;
  pointer-events: none;
}
.btn-scenario--offensive { border-left: 3px solid #ef4444; }
.btn-scenario--offensive:hover { border-color: #ef4444; background: rgba(239,68,68,.06); }
.btn-scenario--defensive { border-left: 3px solid #22c55e; }
.btn-scenario--defensive:hover { border-color: #22c55e; background: rgba(34,197,94,.06); }
.btn-scenario--active { border-color: var(--accent) !important; background: rgba(74,144,217,.10) !important; box-shadow: 0 0 8px rgba(74,144,217,.25); }
.btn-scenario {
  display: flex;
  align-items: flex-start;
  gap: 10px;
}
.btn-scenario small {
  font-size: 11px;
  color: var(--muted);
  font-weight: 400;
  margin-top: 3px;
}
.scenario-btn-id {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 24px;
  height: 24px;
  border-radius: 50%;
  background: rgba(255,255,255,.08);
  font-size: 11px;
  font-weight: 700;
  color: var(--text);
  flex-shrink: 0;
  margin-top: 2px;
}
.btn-scenario--offensive .scenario-btn-id { background: rgba(239,68,68,.15); color: #ef4444; }
.btn-scenario--defensive .scenario-btn-id { background: rgba(34,197,94,.15); color: #22c55e; }
.scenario-btn-content { display: flex; flex-direction: column; text-align: left; }
.scenario-btn-title {
  font-weight: 600;
}
.scenario-btn-path {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px !important;
  color: var(--accent) !important;
  opacity: 0.8;
}

.scenario-category { margin-bottom: 16px; }
.scenario-cat-title {
  font-size: 12px;
  font-weight: 600;
  margin-bottom: 8px;
  padding: 4px 0;
}
.scenario-cat-offensive { color: #ef4444; }
.scenario-cat-defensive { color: #22c55e; }

/* ── Scenario Results — Enhanced Diff ───────────────────────────────── */
.scenario-result {
  margin-top: 14px;
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 16px;
  background: var(--surface2);
}
.scenario-result--offensive { border-left: 3px solid #ef4444; }
.scenario-result--defensive { border-left: 3px solid #22c55e; }

.scenario-result-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 10px;
}
.scenario-result-header h4 {
  font-size: 12px;
  font-weight: 600;
  flex: 1;
  line-height: 1.4;
}

.impact-badge {
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.5px;
  padding: 3px 8px;
  border-radius: 4px;
  white-space: nowrap;
  flex-shrink: 0;
}
.impact-high     { background: rgba(34,197,94,.15); color: #22c55e; border: 1px solid rgba(34,197,94,.3); }
.impact-medium   { background: rgba(245,158,11,.12); color: #f59e0b; border: 1px solid rgba(245,158,11,.3); }
.impact-low      { background: rgba(107,113,148,.12); color: #6b7194; border: 1px solid rgba(107,113,148,.25); }
.impact-high-risk { background: rgba(239,68,68,.15); color: #ef4444; border: 1px solid rgba(239,68,68,.3); }
.impact-med-risk  { background: rgba(245,158,11,.12); color: #f59e0b; border: 1px solid rgba(245,158,11,.3); }
.impact-low-risk  { background: rgba(107,113,148,.12); color: #6b7194; border: 1px solid rgba(107,113,148,.25); }

.scenario-mutation-info {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 12px;
}
.mutation-chip {
  font-size: 10px;
  font-family: 'JetBrains Mono', monospace;
  padding: 4px 10px;
  border-radius: 4px;
  font-weight: 500;
}
.mutation-chip--addEdge    { background: rgba(239,68,68,.1); color: #f87171; border: 1px solid rgba(239,68,68,.2); }
.mutation-chip--removeEdge { background: rgba(34,197,94,.1); color: #4ade80; border: 1px solid rgba(34,197,94,.2); }
.mutation-chip--removeNode { background: rgba(34,197,94,.1); color: #4ade80; border: 1px solid rgba(34,197,94,.2); }

.scenario-vis-hint {
  font-size: 11px;
  color: #ff6b00;
  background: rgba(255,107,0,.06);
  border: 1px solid rgba(255,107,0,.18);
  border-radius: var(--radius);
  padding: 8px 12px;
  margin-bottom: 12px;
  line-height: 1.5;
}

/* ── Metric rows ────────────────────────────────────────────────────── */
.scenario-metrics {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 14px;
}
.metric-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}
.metric-label {
  font-size: 11px;
  font-weight: 600;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.3px;
  min-width: 90px;
}
.metric-values {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 13px;
}
.metric-before {
  color: var(--text2);
  font-weight: 500;
}
.metric-arrow {
  color: var(--muted);
  font-size: 11px;
}
.metric-after {
  font-weight: 700;
}
.metric-delta {
  font-size: 11px;
  font-weight: 600;
}
.delta-better  { color: #22c55e; }
.delta-worse   { color: #ef4444; }
.delta-same    { color: var(--muted); }

/* Risk bars */
.metric-bars {
  display: flex;
  flex-direction: column;
  gap: 5px;
  padding: 0 12px;
  margin-top: -4px;
  margin-bottom: 4px;
}
.metric-bar-row {
  display: flex;
  align-items: center;
  gap: 8px;
}
.metric-bar-label {
  font-size: 10px;
  color: var(--muted);
  min-width: 42px;
  text-align: right;
}
.risk-bar-track {
  flex: 1;
  height: 8px;
  background: var(--surface3);
  border-radius: 4px;
  overflow: hidden;
}
.risk-bar-fill {
  height: 100%;
  border-radius: 4px;
  transition: width 0.5s cubic-bezier(.4,0,.2,1);
}
.metric-bar-val {
  font-size: 10px;
  color: var(--text2);
  min-width: 32px;
  text-align: right;
  font-weight: 500;
}

/* ── Verdict (big percentage) ───────────────────────────────────────── */
.scenario-verdict {
  text-align: center;
  padding: 16px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
}
.verdict-excellent { background: rgba(34,197,94,.08); border-color: #22c55e; }
.verdict-good      { background: rgba(34,197,94,.05); border-color: rgba(34,197,94,.4); }
.verdict-low       { background: rgba(245,158,11,.05); border-color: rgba(245,158,11,.3); }
.verdict-worse     { background: rgba(239,68,68,.08); border-color: #ef4444; }
.verdict-pct {
  display: block;
  font-size: 32px;
  font-weight: 800;
  letter-spacing: -0.5px;
}
.verdict-excellent .verdict-pct { color: #22c55e; }
.verdict-good      .verdict-pct { color: #4ade80; }
.verdict-low       .verdict-pct { color: #f59e0b; }
.verdict-worse     .verdict-pct { color: #ef4444; }
.verdict-label {
  font-size: 10px;
  text-transform: uppercase;
  color: var(--muted);
  letter-spacing: 0.5px;
  margin-top: 2px;
}

.muted { color: var(--muted); font-size: 13px; }

/* ── Charts Drawer ──────────────────────────────────────────────────── */
.charts-drawer {
  background: var(--surface);
  border-top: 1px solid var(--border);
  transition: max-height var(--transition);
  overflow: hidden;
  flex-shrink: 0;
}
.charts-drawer--open {
  max-height: 380px;
}
.charts-drawer--closed {
  max-height: 36px;
}

.charts-drawer-toggle {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  padding: 8px 20px;
  background: var(--surface2);
  border: none;
  border-bottom: 1px solid var(--border);
  color: var(--muted);
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  cursor: pointer;
  transition: var(--transition);
}
.charts-drawer-toggle:hover {
  color: var(--text);
  background: var(--surface3);
}
.toggle-arrow {
  font-size: 10px;
  transition: transform var(--transition);
}
.toggle-arrow.up {
  transform: rotate(180deg);
}

/* ── Stats Charts ───────────────────────────────────────────────────── */
.stats-charts {
  padding: 12px 20px 16px;
  overflow-x: auto;
}
.stats-charts h3 {
  display: none;
}
.stats-charts h4 {
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--muted);
  margin-bottom: 8px;
  font-weight: 600;
}

.charts-row {
  display: flex;
  gap: 12px;
  margin-bottom: 12px;
}

.chart-card {
  flex: 1;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px;
  min-width: 0;
}
.chart-card-full {
  flex: 1 1 100%;
}

.chart-legend-inline {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 8px;
  justify-content: center;
}
.chart-legend-chip {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 10px;
  color: var(--muted);
}
.chart-legend-dot {
  display: inline-block;
  width: 7px;
  height: 7px;
  border-radius: 50%;
}
.reduction-chip {
  color: var(--success);
  font-weight: 700;
  padding: 2px 8px;
  background: rgba(34,197,94,.1);
  border-radius: 10px;
}

/* Chart tooltip */
.chart-tooltip {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 8px 12px;
  font-size: 11px;
  box-shadow: var(--shadow);
}
.chart-tooltip-label {
  font-weight: 600;
  color: var(--text);
  margin-bottom: 2px;
}

/* ── Modal ──────────────────────────────────────────────────────────── */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.75);
  backdrop-filter: blur(4px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}
.modal {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  width: 720px;
  max-height: 80vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 20px 60px rgba(0,0,0,.6);
}
.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  border-bottom: 1px solid var(--border);
}
.modal-header h3 {
  margin: 0;
  color: var(--text);
  text-transform: none;
  font-size: 15px;
}
.btn-close {
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 6px;
  color: var(--muted);
  font-size: 14px;
  cursor: pointer;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
}
.btn-close:hover {
  background: var(--danger);
  color: #fff;
  border-color: var(--danger);
}
.explanation-text {
  padding: 20px;
  overflow-y: auto;
  font-family: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
  font-size: 13px;
  line-height: 1.7;
  white-space: pre-wrap;
  color: var(--text2);
}

/* ── Recharts overrides ─────────────────────────────────────────────── */
.recharts-cartesian-axis-tick-value { fill: var(--muted) !important; }
.recharts-polar-angle-axis-tick-value { fill: var(--muted) !important; }

/* ═══════════════════════════════════════════════════════════════════════
   NEW: Filter Panel Styles
   ═══════════════════════════════════════════════════════════════════════ */
.filter-panel .filter-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.filter-panel .filter-header h3 {
  margin-bottom: 0;
}

.filter-group {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 10px;
}
.filter-group-edges {
  display: flex;
  flex-wrap: wrap;
  flex-direction: row;
  gap: 4px;
}

.filter-check {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  cursor: pointer;
  padding: 4px 8px;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 6px;
  transition: var(--transition);
  color: var(--text2);
}
.filter-check:hover {
  border-color: var(--accent);
  background: var(--surface3);
}
.filter-check-sm {
  font-size: 10px;
  padding: 3px 6px;
}

.filter-dot {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}

.filter-slider {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.filter-slider label {
  font-size: 11px;
  color: var(--muted);
}
.filter-slider input[type="range"] {
  width: 100%;
  accent-color: var(--accent);
  height: 4px;
}

/* ═══════════════════════════════════════════════════════════════════════
   NEW: Focus Mode Styles
   ═══════════════════════════════════════════════════════════════════════ */
.focus-panel .field select {
  max-height: 200px;
}

.radius-labels {
  display: flex;
  justify-content: space-between;
  padding: 0 2px;
  font-size: 10px;
  color: var(--muted);
}

.focus-info {
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-top: 10px;
  padding: 10px;
  background: rgba(74,144,217,.06);
  border: 1px solid rgba(74,144,217,.2);
  border-radius: var(--radius);
}

.focus-badge {
  font-size: 12px;
  color: var(--accent);
  font-weight: 600;
}

.focus-count {
  font-size: 11px;
  color: var(--muted);
}

.topbar-focus {
  color: var(--accent);
  background: rgba(74,144,217,.1);
  font-weight: 500;
}

/* ═══════════════════════════════════════════════════════════════════════
   NEW: Path Animation Player
   ═══════════════════════════════════════════════════════════════════════ */
.animation-overlay {
  position: absolute;
  bottom: 16px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 30;
  width: 90%;
  max-width: 800px;
}

.animation-player {
  background: rgba(15, 17, 23, 0.95);
  backdrop-filter: blur(12px);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 12px 16px;
  box-shadow: var(--shadow);
}

.animation-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}
.animation-title {
  font-size: 12px;
  color: var(--text);
}
.animation-risk {
  font-size: 11px;
  color: var(--warning);
  font-weight: 500;
}

.animation-steps {
  display: flex;
  align-items: center;
  gap: 2px;
  overflow-x: auto;
  padding: 6px 0;
  margin-bottom: 8px;
}
.animation-steps::-webkit-scrollbar { height: 4px; }
.animation-steps::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

.animation-step {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 10px;
  color: var(--muted);
  background: var(--surface2);
  border: 1px solid var(--border);
  cursor: pointer;
  transition: var(--transition);
  white-space: nowrap;
  flex-shrink: 0;
}
.animation-step:hover {
  border-color: var(--accent);
}
.animation-step.visited {
  background: rgba(74,144,217,.15);
  border-color: rgba(74,144,217,.3);
  color: var(--accent);
}
.animation-step.active {
  background: rgba(0,255,136,.15);
  border-color: #00ff88;
  color: #00ff88;
  font-weight: 600;
  box-shadow: 0 0 8px rgba(0,255,136,.3);
}
.step-num {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  background: rgba(255,255,255,.1);
  border-radius: 50%;
  font-size: 9px;
  font-weight: 700;
}
.step-label {
  max-width: 80px;
  overflow: hidden;
  text-overflow: ellipsis;
}
.step-arrow {
  color: var(--muted);
  font-size: 12px;
  margin-left: 2px;
}

.animation-controls {
  display: flex;
  align-items: center;
  gap: 6px;
}
.btn-anim {
  padding: 5px 12px;
  background: var(--surface2);
  color: var(--text2);
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 11px;
  cursor: pointer;
  transition: var(--transition);
  font-weight: 500;
}
.btn-anim:hover {
  background: var(--surface3);
  border-color: var(--accent);
  color: var(--accent);
}
.btn-anim-stop:hover {
  border-color: var(--danger);
  color: var(--danger);
}

.animation-speed {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 11px;
  color: var(--muted);
}
.animation-speed select {
  background: var(--surface2);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 4px;
  font-size: 11px;
  padding: 2px 6px;
}

/* ═══════════════════════════════════════════════════════════════════════
   NEW: Cluster/Subnet Node Styles
   ═══════════════════════════════════════════════════════════════════════ */
.icon-node--cluster {
  min-width: 150px;
  border-style: dashed;
  border-width: 2px;
  border-color: rgba(255,255,255,.3) !important;
}
.icon-node--cluster:hover {
  border-color: var(--accent) !important;
  transform: scale(1.06);
}

/* ═══════════════════════════════════════════════════════════════════════
   NEW: Animation-active node
   ═══════════════════════════════════════════════════════════════════════ */
.icon-node--anim {
  border-color: #00ff88 !important;
  box-shadow:
    0 0 16px rgba(0,255,136,.5),
    0 0 32px rgba(0,255,136,.25),
    inset 0 0 10px rgba(0,255,136,.15);
  transform: scale(1.12);
  z-index: 20;
  animation: anim-glow 1.5s ease-in-out infinite;
}
@keyframes anim-glow {
  0%, 100% { box-shadow: 0 0 16px rgba(0,255,136,.5), 0 0 32px rgba(0,255,136,.25); }
  50%      { box-shadow: 0 0 24px rgba(0,255,136,.7), 0 0 48px rgba(0,255,136,.35); }
}

/* ═══════════════════════════════════════════════════════════════════════
   NEW: Impact Badge
   ═══════════════════════════════════════════════════════════════════════ */
.impact-badge {
  display: inline-block;
  padding: 1px 6px;
  border-radius: 4px;
  font-size: 9px;
  font-weight: 600;
  letter-spacing: 0.3px;
}
.impact-critical {
  background: rgba(220,38,38,.15);
  color: #ef4444;
  border: 1px solid rgba(220,38,38,.3);
}
.impact-high {
  background: rgba(249,115,22,.12);
  color: #f97316;
  border: 1px solid rgba(249,115,22,.3);
}
.impact-medium {
  background: rgba(245,158,11,.1);
  color: #f59e0b;
  border: 1px solid rgba(245,158,11,.3);
}
.impact-low {
  background: rgba(34,197,94,.1);
  color: #22c55e;
  border: 1px solid rgba(34,197,94,.3);
}

/* ══════════════════════════════════════════════════════════════════════
   Dataset Upload Component
   ══════════════════════════════════════════════════════════════════════ */

.dataset-upload {
  padding: 12px 0;
  border-bottom: 1px solid var(--border);
  margin-bottom: 8px;
}

.dataset-upload-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 10px;
}

.dataset-upload-header h3 {
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
  margin: 0;
}

.dataset-upload-icon {
  font-size: 16px;
}

.dataset-info-bar {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  margin-bottom: 10px;
}

.dataset-info-chip {
  font-size: 11px;
  padding: 3px 8px;
  border-radius: 4px;
  background: var(--surface2);
  color: var(--text2);
  border: 1px solid var(--border);
}

.dataset-info-chip strong {
  color: var(--accent);
}

.dataset-file-chip {
  background: rgba(74,144,217,.1);
  border-color: rgba(74,144,217,.3);
  color: var(--accent);
}

.dataset-dropzone {
  border: 2px dashed var(--border);
  border-radius: var(--radius);
  padding: 18px 12px;
  text-align: center;
  cursor: pointer;
  transition: var(--transition);
  background: var(--surface);
  margin-bottom: 8px;
}

.dataset-dropzone:hover {
  border-color: var(--accent);
  background: rgba(74,144,217,.05);
}

.dataset-dropzone--active {
  border-color: var(--accent);
  background: rgba(74,144,217,.1);
}

.dataset-dropzone-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--muted);
}

.dataset-dropzone-icon {
  font-size: 24px;
  color: var(--accent);
  line-height: 1;
}

.dataset-dropzone-content strong {
  color: var(--accent);
}

.dataset-dropzone-hint {
  font-size: 10px;
  color: var(--muted);
  opacity: .7;
}

.dataset-reset-btn {
  width: 100%;
  padding: 7px 12px;
  font-size: 11px;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--surface2);
  color: var(--text2);
  cursor: pointer;
  transition: var(--transition);
}

.dataset-reset-btn:hover {
  background: var(--surface3);
  border-color: var(--border-hl);
  color: var(--text);
}

.dataset-reset-btn:disabled {
  opacity: .5;
  cursor: not-allowed;
}

/* ══════════════════════════════════════════════════════════════════════
   Landing Page — shown before any dataset is loaded
   ══════════════════════════════════════════════════════════════════════ */

.landing {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg);
  padding: 32px;
}

.landing-card {
  max-width: 480px;
  width: 100%;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 40px 32px;
  text-align: center;
  box-shadow: var(--shadow);
}

.landing-icon {
  font-size: 48px;
  margin-bottom: 12px;
  line-height: 1;
}

.landing-heading {
  font-size: 20px;
  font-weight: 700;
  color: var(--text);
  margin: 0 0 8px;
}

.landing-subtext {
  font-size: 13px;
  color: var(--muted);
  line-height: 1.5;
  margin: 0 0 24px;
}

.landing .dataset-upload {
  border-bottom: none;
  margin-bottom: 0;
  padding: 0;
}

.landing .dataset-dropzone {
  padding: 28px 16px;
  border-width: 2px;
}

.landing .dataset-dropzone-icon {
  font-size: 32px;
}
